Min-25 筛本质上是对埃氏筛进行了扩展，用于求解积性函数的前缀和，要求其在质数与质数的次幂处的取值可以被快速计算。

下面对 Min-25 筛的运行过程做一个简要的推导：

记 $\mathbb P$ 中的数为 $p$ ，$p_k$ 为 $\mathbb P$ 中第 $k$ 小的数，${\rm lpf}(n)$（ $\rm lowest\ prime\ factor$ ）为 $n$ 的最小素因子，$F(n)=\sum_{p\le n}f(p)$ ，$F_k(n)=\sum_{i=2}^n[p_k\le{\rm lpf}(i)]f(i)$ ，不难发现答案即为 $F_1(n)+1$ 。

考虑在 $F_k$ 与 $F$ 之间建立递推关系，从素因子的角度出发，并应用积性函数的性质，我们有：
$$
\begin{aligned}
	F_k(n)&=\sum_{i=1}^n[{\rm lpf}(i)\ge k]f(i) \\
	&=\sum_{i\ge k,p_i^2\le n}\sum_{c\ge 1,p_i^c\le n} f(p_i^c)\times([c>1]+F_{k+1}(n/p_i^c))+F(n)-F(p_{k-1})\\
\end{aligned}
$$
现在的问题在于如何快速求取 $F$ 。首先可以注意到只有 $O(\sqrt n)$ 处的 $F_k$ 和 $F$ 的取值对我们来说是有用的，这一点保障了我们的计算复杂度。现在我们只关注 $f$ 在质数处的取值，在具体的问题中，这一部分往往可以被表示为一个低次多项式，因此我们可以考虑分别计算每一项的贡献，最后再把它们加起来。也就是说现在我们只需要求 $g(n)=n^s$ 在只考虑素数处的取值的情况下的前缀和。注意到 $g$ 具有非常优美的性质，其是一个完全积性函数，因此我们考虑构造 $G_k(n)=\sum_{i=2}^n[{\rm lpf}(i)>p_k \lor i \in {\mathbb P}]g(i)$ ，即埃氏筛第 $k$ 轮以后剩下的数处的 $g$ 的取值之和。从埃氏筛的过程入手，我们考虑如何递推求解 $G_k(n)$ ，即：

1. 对于 $p_k^2>n$ ，显然，所有满足的条件的数都会是素数，因此 $G_k(n)=G_{k-1}(n)$ 。
2. 否则我们希望去除掉所有 ${\rm lpf}$ 为 $p_k$ 的合数处的取值，即减去 $g(p_k)G_{k-1}(n/p_k)$ 。
3. 在第 $2$ 步中会多减一部分，这部分均仅含一个小于 $p_k$ 的素因子，因此我们加上 $g(p_k)G_{k-1}(p_{k-1})$ 。

概括一下，我们有：
$$
G_k(n)=G_{k-1}(n)-[p_k^2\le n]g(p_k)(G_{k-1}(n/p_k)-G_{k-1}(p_{k-1}))
$$

以下是洛谷 P5325 求积性函数 $f(p^k)=p^k(p^k-1),p\in\mathbb P$ 的前缀和的代码：
\inputminted{cpp}{src/number theory/min25.cpp}